<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tableau des mesures</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; padding: 24px; color: #1a202c; }
  .container { max-width: 1100px; margin: 0 auto; }
  h2 { font-size: 1.4rem; font-weight: 700; margin-bottom: 16px; color: #2d3748; }

  .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 12px; align-items: flex-start; }
  .search-box {
    flex: 1; min-width: 220px; padding: 9px 14px;
    border: 1.5px solid #cbd5e0; border-radius: 8px;
    font-size: 0.88rem; outline: none; transition: border 0.2s;
  }
  .search-box:focus { border-color: #93d6df; }
  select.simple-select {
    padding: 9px 14px; border: 1.5px solid #cbd5e0;
    border-radius: 8px; font-size: 0.88rem; background: white;
    outline: none; cursor: pointer; height: 38px;
  }
  select.simple-select:focus { border-color: #667eea; }

  .multi-select { position: relative; }
  .multi-select-btn {
    padding: 9px 14px; border: 1.5px solid #cbd5e0; border-radius: 8px;
    font-size: 0.88rem; background: white; cursor: pointer; user-select: none;
    display: flex; align-items: center; gap: 6px; white-space: nowrap;
    min-width: 160px; height: 38px; transition: border 0.2s;
  }
  .multi-select-btn:hover, .multi-select.open .multi-select-btn { border-color: #667eea; }
  .multi-select-btn .arrow { margin-left: auto; font-size: 0.7rem; color: #718096; }
  .multi-select-btn .count {
    background: #667eea; color: white; border-radius: 10px;
    font-size: 0.72rem; padding: 1px 6px; font-weight: 700;
  }
  .multi-select-dropdown {
    display: none; position: absolute; top: calc(100% + 4px); left: 0;
    background: white; border: 1.5px solid #cbd5e0; border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.12); z-index: 100; min-width: 200px;
  }
  .multi-select.open .multi-select-dropdown { display: block; }
  .multi-select-option {
    padding: 9px 14px; cursor: pointer; display: flex; align-items: center;
    gap: 9px; font-size: 0.87rem; transition: background 0.1s;
  }
  .multi-select-option:hover { background: #f7f8ff; }
  .multi-select-option input[type=checkbox] { accent-color: #667eea; width: 15px; height: 15px; cursor: pointer; }

  .reset-btn {
    padding: 9px 16px; background: #667eea; color: white; border: none;
    border-radius: 8px; font-size: 0.88rem; cursor: pointer; height: 38px;
    transition: background 0.2s;
  }
  .reset-btn:hover { background: #5a67d8; }

  .info-bar { font-size: 0.82rem; color: #718096; margin-bottom: 10px; }

  .table-wrapper {
    background: white; border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow-x: auto;
  }

  /* Container query support */
  .container { container-type: inline-size; container-name: main; }

  table { width: 100%; border-collapse: collapse; font-size: 0.85rem; table-layout: fixed; }
  thead { background: #93d6df; color: white; }

  th {
    padding: 12px 14px; text-align: left; user-select: none;
    white-space: nowrap; position: relative; overflow: hidden;
  }
  th.sortable { cursor: pointer; }
  th.sortable:hover { background: rgba(0,0,0,0.08); }
  th { color: #1a202c; }
  th .sort-icon { margin-left: 5px; opacity: 0.6; font-size: 0.72rem; }
  th.asc .sort-icon::after { content: '‚ñ≤'; }
  th.desc .sort-icon::after { content: '‚ñº'; }
  th:not(.asc):not(.desc) .sort-icon::after { content: '‚áÖ'; }

  /* Resize handle */
  .resize-handle {
    position: absolute; right: 0; top: 0; bottom: 0;
    width: 6px; cursor: col-resize;
    background: transparent;
    transition: background 0.15s;
    z-index: 1;
  }
  .resize-handle:hover, .resize-handle.active { background: rgba(255,255,255,0.4); }

  tbody tr { border-bottom: 1px solid #edf2f7; transition: background 0.15s; }
  tbody tr:last-child { border-bottom: none; }
  tbody tr:hover { background: #f7f8ff; }
  td { padding: 11px 14px; vertical-align: top; overflow: hidden; }
  td.mesure-cell { line-height: 1.45; white-space: normal; word-break: break-word; }
  td:not(.mesure-cell) { white-space: normal; }

  .badge {
    display: inline-block; padding: 3px 9px; border-radius: 20px;
    font-size: 0.75rem; font-weight: 600; white-space: nowrap; margin: 2px 2px 2px 0;
  }
  .badge-plan  { background: #bee3f8; color: #2a69ac; }
  .badge-inter { background: #c6f6d5; color: #276749; }
  .badge-appui { background: #fefcbf; color: #744210; }
  .badge-hab   { background: #fed7e2; color: #97266d; }
  .badge-dest  { background: #e9d8fd; color: #553c9a; }
  .badge-mob   { background: #feebc8; color: #7b341e; }
  .badge-mun   { background: #e2e8f0; color: #4a5568; }
  .badge-mrc   { background: #d6bcfa; color: #553c9a; }

  .no-results { text-align: center; padding: 32px; color: #a0aec0; }

  .pagination {
    display: flex; align-items: center; justify-content: center;
    gap: 6px; padding: 16px; border-top: 1px solid #edf2f7; flex-wrap: wrap;
  }
  .page-btn {
    min-width: 34px; height: 34px; padding: 0 10px;
    border: 1.5px solid #cbd5e0; border-radius: 7px; background: white;
    font-size: 0.85rem; cursor: pointer; display: flex; align-items: center;
    justify-content: center; transition: all 0.15s; color: #4a5568;
  }
  .page-btn:hover:not(:disabled) { border-color: #93d6df; color: #93d6df; }
  .page-btn.active { background: #93d6df; border-color: #93d6df; color: white; font-weight: 700; }
  .page-btn:disabled { opacity: 0.35; cursor: default; }

  /* prevent text selection while resizing */
  body.resizing { cursor: col-resize !important; user-select: none !important; }

  /* ‚îÄ‚îÄ Mobile card layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
  @container main (max-width: 768px) {
    body { padding: 14px; }

    .controls { flex-direction: column; }
    .search-box, .multi-select, .multi-select-btn,
    select.simple-select, .reset-btn { width: 100%; min-width: unset; }
    .multi-select-btn { min-width: unset; }

    .table-wrapper { border-radius: 8px; overflow: hidden; }

    /* Hide table header on mobile */
    table thead { display: none; }
    table, tbody { display: block; width: 100%; }

    /* Each row becomes a card */
    tbody tr {
      display: block;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      margin: 8px 10px;
      padding: 12px;
      background: white;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    tbody tr:hover { background: #f0fafb; }
    tbody tr:last-child { border-bottom: 1px solid #e2e8f0; }

    /* Hide all td by default, show as block */
    tbody td { display: block; padding: 0; border: none; overflow: visible; }

    /* Badges row: cat + palier + type on one line, wrapping */
    tbody td:nth-child(1),
    tbody td:nth-child(2),
    tbody td:nth-child(3) { display: inline; }

    /* Badges container trick: wrap the first 3 tds in a flex-like row */
    tbody td:nth-child(1)::before { content: ''; display: block; margin-bottom: 6px; }
    tbody td:nth-child(3)::after  { content: ''; display: block; margin-bottom: 8px; }

    /* Mesure text */
    tbody td.mesure-cell {
      display: block;
      font-size: 0.87rem;
      line-height: 1.5;
      color: #2d3748;
      border-top: 1px solid #edf2f7;
      padding-top: 8px;
      margin-top: 4px;
    }

    /* Pagination adjustments */
    .pagination { gap: 4px; padding: 12px 8px; }
    .page-btn { min-width: 30px; height: 30px; font-size: 0.8rem; }
  }
</style>
</head>
<body>
<div class="container">
  <h2>üìã Mesures pour des milieux de vie de qualit√©</h2>
  <div class="controls">
    <input class="search-box" id="search" type="text" placeholder="üîç Rechercher dans les mesures‚Ä¶">

    <div class="multi-select" id="ms-cat">
      <div class="multi-select-btn" onclick="toggleDropdown('ms-cat')">
        <span id="ms-cat-label">Toutes les cat√©gories</span>
        <span class="arrow">‚ñæ</span>
      </div>
      <div class="multi-select-dropdown">
        <label class="multi-select-option"><input type="checkbox" value="Habitation" onchange="onCheck('cat')"> Habitation</label>
        <label class="multi-select-option"><input type="checkbox" value="Destinations" onchange="onCheck('cat')"> Destinations</label>
        <label class="multi-select-option"><input type="checkbox" value="Mobilit√©" onchange="onCheck('cat')"> Mobilit√©</label>
      </div>
    </div>

    <div class="multi-select" id="ms-palier">
      <div class="multi-select-btn" onclick="toggleDropdown('ms-palier')">
        <span id="ms-palier-label">Tous les paliers</span>
        <span class="arrow">‚ñæ</span>
      </div>
      <div class="multi-select-dropdown">
        <label class="multi-select-option"><input type="checkbox" value="Municipalit√©" onchange="onCheck('palier')"> Municipalit√©</label>
        <label class="multi-select-option"><input type="checkbox" value="MRC" onchange="onCheck('palier')"> MRC</label>
      </div>
    </div>

    <select class="simple-select" id="filter-type">
      <option value="">Tous les types</option>
      <option>Planification et r√©glementation</option>
      <option>Interventions directes</option>
      <option>Appui d'initiatives</option>
    </select>

    <button class="reset-btn" onclick="reset()">R√©initialiser</button>
  </div>
  <div class="info-bar" id="info-bar"></div>
  <div class="table-wrapper">
    <table id="main-table">
      <colgroup>
        <col id="col-0" style="width:140px">
        <col id="col-1" style="width:140px">
        <col id="col-2" style="width:175px">
        <col id="col-3">
      </colgroup>
      <thead>
        <tr>
          <th class="sortable" onclick="sortTable(0)">Cat√©gorie <span class="sort-icon"></span><div class="resize-handle" data-col="0"></div></th>
          <th class="sortable" onclick="sortTable(1)">Palier <span class="sort-icon"></span><div class="resize-handle" data-col="1"></div></th>
          <th class="sortable" onclick="sortTable(2)">Type <span class="sort-icon"></span><div class="resize-handle" data-col="2"></div></th>
          <th class="sortable" onclick="sortTable(3)">Mesure <span class="sort-icon"></span></th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
    <div class="no-results" id="no-results" style="display:none">Aucun r√©sultat trouv√©.</div>
    <div class="pagination" id="pagination"></div>
  </div>
</div>

<script>
// [cat, palier, type, mesure]
const raw = [
  ["Habitation","Municipalit√©, MRC","Planification et r√©glementation","R√©aliser un portrait du parc de logements (en analysant notamment la diversit√© de taille, le mode d'occupation, l'offre de logements √† but non lucratif, et le taux d'inoccupation) pour identifier, dans les documents de planification, les secteurs o√π l'offre doit √™tre am√©lior√©e en priorit√©."],
  ["Habitation","Municipalit√©, MRC","Planification et r√©glementation","Se doter d'une politique d'habitation avec des objectifs et des cibles pour diversifier l'offre de logements (en mati√®re de taille notamment) et augmenter l'abordabilit√© (offre g√©n√©rale et de logements √† but non lucratifs)."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Se doter d'outils r√©glementaires permettant de diversifier l'offre de logements (p. ex. r√®glement pour am√©liorer l'offre de logements abordables, sociaux ou familiaux, zonage diff√©renci√©, zonage incitatif)."],
  ["Habitation","Municipalit√©, MRC","Interventions directes","Utiliser la ma√Ætrise fonci√®re et d'ouvrage via des appels √† projets pour les terrains publics municipaux incluant des crit√®res et obligations destin√©s √† augmenter l'offre, la diversit√© et l'abordabilit√©."],
  ["Habitation","Municipalit√©, MRC","Appui d'initiatives","Soutenir les projets d'habitation √† but non lucratif qui contribuent √† la diversit√© de l'offre r√©sidentielle (p. ex. subvention financi√®re, exemption ou cr√©dit de taxes)."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Se doter d'outils r√©glementaires visant √† conserver le parc de logements locatifs en encadrant notamment la transformation des immeubles locatifs en copropri√©t√©s divises, et location touristique."],
  ["Habitation","Municipalit√©","Interventions directes","Se doter d'un service d'aide √† la recherche de logement (SARL) pour accompagner les m√©nages."],
  ["Habitation","Municipalit√©, MRC","Appui d'initiatives","Adopter un programme d'aide visant √† favoriser la construction ou l'am√©nagement de logements locatifs."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Modifier la r√©glementation d'urbanisme de mani√®re √† favoriser la densification et la consolidation (p. ex. ajout d'unit√©s d'habitation accessoires, autorisation de formes plus denses, r√©duction des marges des tailles minimales des lots, et des exigences de stationnement)."],
  ["Mobilit√©, Habitation","Municipalit√©, MRC","Planification et r√©glementation","Augmenter la densit√© permise dans les milieux de vie consid√©r√©s comme complets ou ayant un fort potentiel de le devenir, particuli√®rement ceux situ√©s au sein ou √† proximit√© des centralit√©s et le long des axes structurants de transport en commun."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Faire l'acquisition (p. ex. gr√¢ce au droit de pr√©emption) de terrains propices au red√©veloppement et strat√©giquement localis√©s (p. ex. friche industrielle, b√¢timents vacants sur une rue commerciale)."],
  ["Habitation","Municipalit√©","Interventions directes","Planifier la mise √† niveau des r√©seaux d'aqueduc et d'√©gout pour r√©pondre aux besoins de l'ajout de nouveaux logements."],
  ["Habitation, Destinations","Municipalit√©","Planification et r√©glementation","Mettre en place une taxation suppl√©mentaire des terrains sous-d√©velopp√©s (p. ex. grands espaces de stationnement et terrains vacants) dans les centralit√©s et √† proximit√©."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Identifier les terrains et immeubles vacants ou sous-utilis√©s (publics ou priv√©s) pr√©sentant un potentiel d'√™tre transform√©s pour accueillir des logements."],
  ["Habitation","Municipalit√©","Planification et r√©glementation","Se doter d'outils r√©glementaires permettant d'augmenter l'offre de logements √† but non lucratifs (p. ex. r√©glementation sur l'inclusion de logements abordables, zonage diff√©renci√©, zonage incitatif)."],
  ["Habitation","Municipalit√©, MRC","Planification et r√©glementation","Soutenir l'√©mergence de formules innovantes d'habitation (p. ex. autopromotion, cohabitat, coop√©rative de solidarit√©)."],
  ["Destinations","Municipalit√©, MRC","Appui d'initiatives","Soutenir les initiatives communautaires r√©pondant aux besoins de base de la population (p. ex. en alimentation, √©ducation, socialisation) par du financement ou un soutien logistique."],
  ["Destinations","Municipalit√©","Appui d'initiatives","Soutenir l'implantation et le maintien de destinations du quotidien (p. ex. commerce alimentaire, service de soin, tiers-lieu, CPE) dans les centralit√©s."],
  ["Destinations","Municipalit√©, MRC","Planification et r√©glementation","R√©aliser un portrait des destinations locales et identifier, dans les documents de planification, les secteurs o√π l'offre doit √™tre bonifi√©e."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Modifier la r√©glementation d'urbanisme de mani√®re √† limiter les d√©serts alimentaires (p. ex. autoriser les commerces alimentaires de petite superficie dans les zones r√©sidentielles)."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Faciliter l'agriculture urbaine en l'autorisant dans la r√©glementation, en offrant des espaces pour des jardins communautaires ou collectifs."],
  ["Destinations, Mobilit√©","Municipalit√©, MRC","Appui d'initiatives","Se doter d'une politique d'accessibilit√© universelle, accompagn√© d'un programme pour soutenir l'adaptation des lieux et des b√¢timents accueillant du public."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Se doter d'une politique alimentaire et identifier des actions prioritaires pour am√©liorer l'offre alimentaire de proximit√©."],
  ["Destinations","Municipalit√©, MRC","Planification et r√©glementation","Planifier une r√©partition √©quitable des √©quipements et services publics et parapublics (√©coles, services de garde, parcs et √©quipements culturels) sur le territoire."],
  ["Destinations, Mobilit√©","Municipalit√©, MRC","Planification et r√©glementation","Privil√©gier l'implantation des destinations du quotidien et des g√©n√©rateurs de d√©placements dans les centralit√©s, ainsi qu'√† proximit√© des services publics et du transport en commun."],
  ["Destinations, Mobilit√©","Municipalit√©","Interventions directes","Planifier et prioriser les interventions pour s√©curiser le r√©seau actif en fonction des risques et de la proximit√© de personnes en situation de vuln√©rabilit√©."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Autoriser certaines activit√©s de proximit√© (p. ex. service de garde, clinique m√©dicale, pharmacie) dans les zones r√©sidentielles, ainsi qu'en tant qu'usage compl√©mentaire pour les immeubles multilogements."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Planifier l'acquisition de terrains et la construction des √©coles sur des emplacements au c≈ìur des milieux de vie, particuli√®rement lors de la cr√©ation ou de la consolidation d'un quartier."],
  ["Destinations","Municipalit√©","Interventions directes","Accorder une plus grande place √† la v√©g√©tation dans les milieux de vie (p. ex. augmentation de la canop√©e, int√©gration d'infrastructures naturelles, d√©min√©ralisation de terrains priv√©s)."],
  ["Destinations","Municipalit√©","Interventions directes","R√©aliser des ententes de type ¬´parc-√©cole¬ª et soutenir la d√©min√©ralisation et le verdissement des terrains scolaires."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Exiger une contribution pour fins de parc lors d'une demande de permis de lotissement ou de construction."],
  ["Destinations","Municipalit√©","Interventions directes","Am√©nager des acc√®s publics balis√©s et bien identifi√©s aux principaux plans d'eau de la municipalit√© (p. ex. sentiers, plages)."],
  ["Destinations, Mobilit√©","Municipalit√©","Planification et r√©glementation","R√©aliser un portrait des espaces publics pour identifier les lacunes dans leur am√©nagement et en planifier le r√©am√©nagement pour en accro√Ætre la qualit√©, l'appropriabilit√© et l'inclusivit√©."],
  ["Destinations","Municipalit√©","Interventions directes","Assurer la pr√©sence d'installations sanitaires accessibles dans les lieux fr√©quent√©s par le public."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Autoriser et encourager la mixit√© d'activit√©s dans les √©quipements publics et le partage de locaux institutionnels."],
  ["Destinations","Municipalit√©","Interventions directes","Augmenter l'offre en espaces publics appropriables (p. ex. cr√©ation de nouveaux espaces sur les terrains municipaux, remplacement de stationnement par des placettes, pi√©tonnisation temporaire, saisonni√®re ou permanente)."],
  ["Destinations","Municipalit√©","Appui d'initiatives","Augmenter l'offre d'activit√©s d'animation de l'espace public (p. ex. √©v√©nements communautaires, activit√©s culturelles, ventes de rue) en collaboration avec les organismes et les artistes du milieu."],
  ["Destinations, Mobilit√©","Municipalit√©","Planification et r√©glementation","Am√©liorer la qualit√© de l'espace public sur les rues commerciales afin d'attirer des commerces et d'inciter les investissements priv√©s (p. ex. v√©g√©tation, mobilier, terrasses)."],
  ["Destinations","Municipalit√©","Planification et r√©glementation","Renforcer les centralit√©s en y concentrant les activit√©s compatibles (habitations, commerces, bureaux et √©quipements publics), entre autres via des programmes incitatifs."],
  ["Destinations","Municipalit√©, MRC","Interventions directes","Se doter d'un registre des locaux commerciaux qui inclut leur statut d'occupation afin de suivre et d'encourager leur occupation."],
  ["Destinations","Municipalit√©","Interventions directes","Optimiser la gestion du stationnement public (sur et hors rue) par la r√©glementation et la tarification, de mani√®re √† assurer un roulement favorable √† la client√®le."],
  ["Habitation, Destinations","Municipalit√©","Interventions directes","R√©habiliter les terrains contamin√©s dans les secteurs √† consolider (p. ex. centre-ville, secteur propice √† la consolidation)."],
  ["Mobilit√©","Municipalit√©","Planification et r√©glementation","R√©duire la vitesse autoris√©e √† 30 km/h sur les voies locales."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Planifier et am√©nager les r√©seaux cyclable et pi√©tonnier en tenant compte du r√¥le des rues dans la trame."],
  ["Mobilit√©","Municipalit√©, MRC","Interventions directes","Assurer un entretien prioritaire des r√©seaux pi√©tonnier et cyclable et des voies emprunt√©es par le transport en commun, particuli√®rement en hiver."],
  ["Mobilit√©","Municipalit√©, MRC","Planification et r√©glementation","Se doter d'un plan de mobilit√© active ou d'un plan directeur des r√©seaux pi√©tonnier et cyclable incluant un diagnostic et des mesures de bonification des r√©seaux."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Am√©nager les intersections de mani√®re √† s√©curiser la travers√©e des personnes qui se d√©placent √† pied ou √† v√©lo (p. ex. trottoirs traversants, intersections prot√©g√©es, feux avec phase pi√©tonni√®re exclusive)."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Am√©liorer l'accessibilit√© universelle des b√¢timents et des espaces publics, en assurant notamment des parcours continus, sans obstacles, sur des trottoirs larges et adapt√©s."],
  ["Mobilit√©","Municipalit√©","Planification et r√©glementation","D√©velopper un guide de conception des rues pour assurer la coh√©rence des am√©nagements (pi√©tonniers, cyclables et d'infrastructures vertes) selon les diff√©rents types de voies."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Assurer la pr√©sence de trottoirs de bonne qualit√© et de largeur suffisante, particuli√®rement sur les voies structurantes."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Privil√©gier les pistes cyclables larges et s√©par√©es de la chauss√©e et des am√©nagements pi√©tonniers pour plus de s√©curit√©. Pr√©f√©rer les pistes unidirectionnelles."],
  ["Mobilit√©","Municipalit√©","Planification et r√©glementation","Augmenter l'offre de stationnement pour v√©los dans les projets immobiliers, pour les commerces et sur l'espace public."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Profiter de la r√©fection des rues pour r√©duire la largeur des chauss√©es et implanter des am√©nagements pi√©tonniers et cyclables, ainsi que des infrastructures vertes."],
  ["Mobilit√©, Destinations","Municipalit√©","Interventions directes","Offrir des informations directionnelles pour les destinations cl√©s avec des indications de distance pour faciliter l'orientation des cyclistes et des pi√©tons."],
  ["Mobilit√©","Municipalit√©, MRC","Planification et r√©glementation","R√©aliser un portrait de la mobilit√© pour identifier les forces et les lacunes en mati√®re d'infrastructures et de services."],
  ["Mobilit√©","Municipalit√©","","Se doter d'un plan de mobilit√© durable destin√© √† am√©liorer l'offre en mati√®re de transport collectif et de mobilit√© partag√©e."],
  ["Mobilit√©","Municipalit√©, MRC","Planification et r√©glementation","Planifier des p√¥les d'√©changes intermodaux dans les c≈ìurs de collectivit√© ou pr√®s des concentrations d'activit√©s."],
  ["Mobilit√©, Habitation","Municipalit√©","Planification et r√©glementation","R√©viser la r√©glementation en mati√®re de stationnement (p. ex. abolition ou r√©duction des exigences, imposition de normes maximales √† proximit√© du transport en commun)."],
  ["Mobilit√©","Municipalit√©, MRC","Appui d'initiatives","D√©velopper et soutenir une offre de transport collectif compl√©mentaire ou palliative au transport en commun (p. ex. transport √† la demande, transport b√©n√©vole, covoiturage)."],
  ["Mobilit√©","Municipalit√©, MRC","Planification et r√©glementation","Planifier le prolongement du r√©seau de transport en commun en priorisant la desserte des concentrations d'activit√©s peu ou mal desservies."],
  ["Mobilit√©","Municipalit√©","Interventions directes","Mettre en place des mesures pr√©f√©rentielles pour les bus (p. ex. voies r√©serv√©es, priorit√© aux feux de circulation, localisation des arr√™ts)."],
  ["Mobilit√©","Municipalit√©","Planification et r√©glementation","Utiliser le stationnement comme levier pour stimuler le d√©veloppement de l'autopartage (p. ex. exigence de cases d√©di√©es dans des projets immobiliers majeurs)."],
  ["Mobilit√©","Municipalit√©, MRC","Interventions directes","Soutenir les initiatives d'autopartage priv√©es ou communautaires sur le territoire."],
  ["Mobilit√©","Municipalit√©","Interventions directes","D√©ployer un syst√®me de v√©los en libre-service."],
];

const PER_PAGE = 20;
let sortCol = -1, sortDir = 1;
let selCat = new Set(), selPalier = new Set();
let currentPage = 1;
let filteredRows = [];

// ‚îÄ‚îÄ Badge helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function typeBadge(t) {
  if (!t) return '';
  const cls = t.includes('Planification') ? 'badge-plan' : t.includes('Interventions') ? 'badge-inter' : 'badge-appui';
  const label = t.includes('Planification') ? 'Planification & r√©gl.' : t.includes('Interventions') ? 'Interventions directes' : "Appui d'initiatives";
  return `<span class="badge ${cls}">${label}</span>`;
}
function catBadges(c) {
  if (!c) return '';
  return c.split(',').map(s => {
    s = s.trim();
    const cls = s === 'Habitation' ? 'badge-hab' : s === 'Destinations' ? 'badge-dest' : 'badge-mob';
    return `<span class="badge ${cls}">${s}</span>`;
  }).join(' ');
}
function palierBadges(p) {
  if (!p) return '';
  return p.split(',').map(s => {
    s = s.trim();
    return `<span class="badge ${s === 'MRC' ? 'badge-mrc' : 'badge-mun'}">${s}</span>`;
  }).join(' ');
}

// ‚îÄ‚îÄ Dropdowns ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleDropdown(id) {
  const el = document.getElementById(id);
  const open = el.classList.contains('open');
  document.querySelectorAll('.multi-select.open').forEach(e => e.classList.remove('open'));
  if (!open) el.classList.add('open');
}
document.addEventListener('click', e => {
  if (!e.target.closest('.multi-select'))
    document.querySelectorAll('.multi-select.open').forEach(el => el.classList.remove('open'));
});
function onCheck(type) {
  const set = type === 'cat' ? selCat : selPalier;
  const msId = type === 'cat' ? 'ms-cat' : 'ms-palier';
  const labelId = type === 'cat' ? 'ms-cat-label' : 'ms-palier-label';
  const def = type === 'cat' ? 'Toutes les cat√©gories' : 'Tous les paliers';
  set.clear();
  document.querySelectorAll(`#${msId} input:checked`).forEach(cb => set.add(cb.value));
  const btn = document.querySelector(`#${msId} .multi-select-btn`);
  btn.querySelectorAll('.count').forEach(el => el.remove());
  document.getElementById(labelId).textContent = set.size ? [...set].join(', ') : def;
  if (set.size) { const b = document.createElement('span'); b.className='count'; b.textContent=set.size; btn.appendChild(b); }
  currentPage = 1; render();
}

// ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function render() {
  const q = document.getElementById('search').value.toLowerCase();
  const fType = document.getElementById('filter-type').value;

  filteredRows = raw.filter(r => {
    const textMatch = r.join(' ').toLowerCase().includes(q);
    const typeOk   = !fType || r[2] === fType;
    const catOk    = selCat.size === 0    || [...selCat].some(c => r[0].includes(c));
    const palierOk = selPalier.size === 0 || [...selPalier].some(p => r[1].includes(p));
    return textMatch && typeOk && catOk && palierOk;
  });

  if (sortCol >= 0)
    filteredRows.sort((a, b) => a[sortCol].localeCompare(b[sortCol], 'fr') * sortDir);

  const total = filteredRows.length;
  const totalPages = Math.max(1, Math.ceil(total / PER_PAGE));
  if (currentPage > totalPages) currentPage = totalPages;

  const start = (currentPage - 1) * PER_PAGE;
  const end   = Math.min(start + PER_PAGE, total);

  document.getElementById('tbody').innerHTML = filteredRows.slice(start, end).map(r =>
    `<tr>
      <td>${catBadges(r[0])}</td>
      <td>${palierBadges(r[1])}</td>
      <td>${typeBadge(r[2])}</td>
      <td class="mesure-cell">${r[3]}</td>
    </tr>`
  ).join('');

  document.getElementById('no-results').style.display = total ? 'none' : 'block';
  document.getElementById('info-bar').textContent =
    `Affichage de ${total ? start+1 : 0}‚Äì${end} sur ${total} r√©sultat(s) (${raw.length} mesures au total)`;

  renderPagination(totalPages);
}

function renderPagination(totalPages) {
  const pg = document.getElementById('pagination');
  if (totalPages <= 1) { pg.innerHTML = ''; return; }
  let pages = [];
  for (let i = 1; i <= totalPages; i++) {
    if (i===1 || i===totalPages || (i>=currentPage-2 && i<=currentPage+2)) pages.push(i);
    else if (pages[pages.length-1] !== '‚Ä¶') pages.push('‚Ä¶');
  }
  pg.innerHTML =
    `<button class="page-btn" onclick="goPage(${currentPage-1})" ${currentPage===1?'disabled':''}>‚Äπ Pr√©c.</button>` +
    pages.map(p => p==='‚Ä¶'
      ? `<button class="page-btn" disabled>‚Ä¶</button>`
      : `<button class="page-btn ${p===currentPage?'active':''}" onclick="goPage(${p})">${p}</button>`
    ).join('') +
    `<button class="page-btn" onclick="goPage(${currentPage+1})" ${currentPage===totalPages?'disabled':''}>Suiv. ‚Ä∫</button>`;
}

function goPage(p) {
  currentPage = p; render();
  document.querySelector('.table-wrapper').scrollIntoView({behavior:'smooth', block:'start'});
}

function sortTable(col) {
  document.querySelectorAll('th').forEach(th => th.classList.remove('asc','desc'));
  if (sortCol === col) sortDir *= -1; else { sortCol = col; sortDir = 1; }
  document.querySelectorAll('th')[col].classList.add(sortDir===1?'asc':'desc');
  currentPage = 1; render();
}

function reset() {
  document.getElementById('search').value = '';
  document.getElementById('filter-type').value = '';
  selCat.clear(); selPalier.clear();
  ['ms-cat','ms-palier'].forEach(id => {
    document.querySelectorAll(`#${id} input`).forEach(cb => cb.checked = false);
    document.querySelector(`#${id} .multi-select-btn .count`)?.remove();
  });
  document.getElementById('ms-cat-label').textContent = 'Toutes les cat√©gories';
  document.getElementById('ms-palier-label').textContent = 'Tous les paliers';
  sortCol = -1; sortDir = 1; currentPage = 1;
  document.querySelectorAll('th').forEach(th => th.classList.remove('asc','desc'));
  render();
}

document.getElementById('search').addEventListener('input', () => { currentPage=1; render(); });
document.getElementById('filter-type').addEventListener('change', () => { currentPage=1; render(); });

// ‚îÄ‚îÄ Column resize ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
(function() {
  let dragging = false, colIdx = null, startX = 0, startW = 0;

  document.querySelectorAll('.resize-handle').forEach(handle => {
    handle.addEventListener('mousedown', e => {
      e.preventDefault(); e.stopPropagation();
      colIdx  = +handle.dataset.col;
      startX  = e.clientX;
      startW  = document.getElementById(`col-${colIdx}`).offsetWidth;
      dragging = true;
      handle.classList.add('active');
      document.body.classList.add('resizing');
    });
  });

  document.addEventListener('mousemove', e => {
    if (!dragging) return;
    const w = Math.max(60, startW + (e.clientX - startX));
    document.getElementById(`col-${colIdx}`).style.width = w + 'px';
  });

  document.addEventListener('mouseup', () => {
    if (!dragging) return;
    dragging = false;
    document.querySelectorAll('.resize-handle').forEach(h => h.classList.remove('active'));
    document.body.classList.remove('resizing');
  });
})();

render();
</script>
</body>
</html>
